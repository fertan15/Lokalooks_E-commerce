<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>LokaLooks</title>
    <!-- FAVICON -->
    <link rel="icon" href="./img/favicon_io/favicon.ico">
    <!-- FONT -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Anton&family=Cinzel:wght@400..900&family=Cutive&family=Lobster&family=Nunito:ital,wght@0,200..1000;1,200..1000&family=Playfair+Display:ital,wght@0,400..900;1,400..900&family=Satisfy&family=Staatliches&display=swap" rel="stylesheet">
    <!-- BOXICON -->
    <link href='https://unpkg.com/boxicons@2.1.4/css/boxicons.min.css' rel='stylesheet'>
    <!-- BOOTSTRAP -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <!-- Your existing CSS -->
    <link rel="stylesheet" href="detail.css">
</head>
<body>
    <div class="all-container">
        <!-- navbar -->
        <nav class="navbar sticky-top navbar-expand-lg bg-dark navbar-dark">
          <div class="container-fluid">
            <!-- Offcanvas Menu Toggler -->
            <button
              class="navbar-toggler"
              type="button"
              data-bs-toggle="offcanvas"
              data-bs-target="#offcanvasNavbar"
              aria-controls="offcanvasNavbar"
              aria-expanded="false"
              aria-label="Toggle navigation"
            >
              <span class="navbar-toggler-icon"></span>
            </button>
            <!-- Logo -->
            <a class="navbar-brand lobster-regular d-block d-lg-inline mb-2 mx-lg-5 mx-auto" style="font-size: 2rem; text-shadow: black 5px 5px; margin-left: 50px;" href="./Home.html">LocaLooks</a>
            <!-- Offcanvas -->
            <div class="offcanvas offcanvas-start" tabindex="-1" id="offcanvasNavbar" aria-labelledby="offcanvasNavbarLabel">
              <div class="offcanvas-header">
                <h5 class="offcanvas-title lobster-regular" style="font-size: 3rem;" id="offcanvasNavbarLabel">LocaLooks</h5>
                <button
                  type="button"
                  class="btn-close"
                  data-bs-dismiss="offcanvas"
                  aria-label="Close"
                ></button>
              </div>
              <div class="offcanvas-body">
                <ul class="navbar-nav m-auto mb-2 mb-lg-0" style="margin-right: 50px;">
                  <li class="nav-item ml-3">
                    <a class="nav-link active" id="color" aria-current="page" href="#">Home</a>
                  </li>
                  <li class="nav-item ml-3">
                    <a class="nav-link" id="color" href="./shop.html">Shop</a>
                  </li>
                  <li class="nav-item ml-3">
                    <a class="nav-link" id="color" href="./about.html">About Us</a>
                  </li>
                  <li class="nav-item ml-3">
                    <a class="nav-link position-relative" id="color" href="./game.html" data-bs-toggle="popover" title="Play, Win, Repeat! Limited-Time Mini Games Are Here!" data-bs-content="Step into the excitement with our exclusive limited-time mini games!">Mini Game</a>
                  </li>
                </ul>
              </div>
            </div>    
            <!-- Cart Icon -->
            <ul class="navbar-nav ms-auto mb-2 mb-lg-0">
              <li class="nav-item">
                <a class="nav-link position-relative" style="font-size: 2rem; margin-right: 50px;" aria-current="page" href="./cart.html">
                    <i class='bx bx-shopping-bag'></i>
                    <span class="position-absolute top-50 start-100 translate-middle-x badge rounded-circle bg-danger" style="font-size: 0.6rem; padding: 0.1rem 0.3rem; min-width: 1rem; height: 1rem; line-height: 0.8rem; transform: translateX(-100%);">
                        0
                        <span class="visually-hidden">Shopping Cart</span>
                    </span>
                </a>
              </li>
            </ul>
          </div>
        </nav>
      <!-- end navbar -->


        <!-- Detail Section -->
        <section class="detail">
            <div class="perfotoan">
                <div class="kiri">
                    <button onclick="updateDisplay('image')"><img id="image" src="" alt="gambar produk"></button>
                    <button onclick="updateDisplay('image1')"><img id="image1" src="" alt="gambar produk"></button>
                    <button onclick="updateDisplay('image2')"><img id="image2" src="" alt="gambar produk"></button>
                </div>
                <div class="tengah">
                    <img id="display" src="" alt="Display gambar produk">
                </div>
            </div>
            <div class="kanan">
                <div class="brand"></div>
                <div class="name"></div>
                <div class="description"></div>
                <div class="price"></div>
                <div class="size-selection">
                    <p>Select Size:</p>
                    <div id="size-buttons">
                        <button class="size-button" onclick="selectSize('S')">S</button>
                        <button class="size-button" onclick="selectSize('M')">M</button>
                        <button class="size-button" onclick="selectSize('L')">L</button>
                        <button class="size-button" onclick="selectSize('XL')">XL</button>
                    </div>
                </div>
                <div class="quantity">
                    <p>Quantity:</p>
                    <input type="number" id="quantity-input" value="1" min="1" step="1">
                </div>
                <button class="add-to-cart" onclick="addToCart()">Add to Cart</button>
            </div>
        </section>

        <!-- Recommended Section -->
        <section class="recommended">
            <h2 style="margin-bottom: 40px; font-size: 3rem; font-family: anton;">Recommended Products</h2>
            <div class="recommended-products"></div>
        </section>

        
      <!-- register email -->
      <section id="reg" class="py-5 bg-dark text-white">
        <div class="container">
          <div class="row justify-content-center">
            <div class="col-md-8 col-lg-6 text-center">
              <h2 class="mb-4 lobster-regular">Register for News and Offers</h2>
              <form id="emailForm" onsubmit="return validateEmail()">
                <div class="input-group mb-3">
                  <input type="email" name="subs" id="subs" class="form-control form-control-lg rounded-pill" placeholder="Enter Your Email" required>
                  <button class="btn btn-primary rounded-pill" type="submit" id="submit">
                    <i class='bx bx-paper-plane'></i> Send
                  </button>
                </div>
              </form>
            </div>
          </div>
        </div>
      </section>

      <!-- Email Registered Modal -->
      <div class="modal fade" id="staticBackdrop" data-bs-backdrop="static" data-bs-keyboard="false" tabindex="-1" aria-labelledby="staticBackdropLabel" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered modal-lg">
          <div class="modal-content">
            <div class="modal-header">
              <h5 class="modal-title" id="staticBackdropLabel">Email Registered</h5>
              <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
              Thank you for subscribing! You're now part of our exclusive circle. Stay tuned for updates, special offers, and exciting news coming your way!
            </div>
            <div class="modal-footer">
              <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
            </div>
          </div>
        </div>
      </div>

      <!-- ini js -->
      <script>
        document.getElementById("submit").addEventListener('click', function(event) {
          event.preventDefault();
          validateEmail();
        });

        function validateEmail() {
          var email = document.getElementById("subs").value;
          var modalContainer = document.getElementById("mod");

          if (email.trim() != "") {
            var myModal = new bootstrap.Modal(document.getElementById('staticBackdrop'), {
              keyboard: false
            });
            myModal.show();

            document.getElementById("subs").value = "";
          } else {
            alert("Please enter a valid email address.");
          }
        }
      </script>
          <!-- end register email -->

          <!-- footer -->
          <footer class="footer">
            <div class="footer-container">
                <div class="footer-section about">
                    <h2>About Us</h2>
                    <p style="text-align: justify;">Welcome to LocaLooks, your ultimate destination for curated local fashion. We are a homegrown e-commerce platform that celebrates the beauty, talent, and creativity of local artisans and designers. Our mission is to bring you closer to the unique charm of locally crafted clothing while supporting small businesses and fostering sustainable practices.</p>
                </div>
    
                <div class="footer-section links">
                    <h2>Quick Links</h2>
                    <ul>
                        <li><a href="#">Home</a></li>
                        <li><a href="./shop.html">Shop</a></li>
                        <li><a href="./about.html">About Us</a></li>
                        <li><a href="./game.html">Mini Game</a></li>
                    </ul>
                </div>
    
                <div class="footer-section contact">
                    <h2>Contact Us</h2>
                    <ul>
                        <li>Email: support@localooks.com</li>
                        <li>Phone: +123 456 7890</li>
                    </ul>
                </div>
    
                <div class="footer-section social">
                    <h2>Follow Us</h2>
                    <div class="social-icons">
                        <a href="https://www.facebook.com/"><i class='bx bxl-facebook-circle'></i></a>
                        <a href="https://www.instagram.com/"><i class='bx bxl-instagram-alt'></i></a>
                        <a href="https://www.whatsapp.com/"><i class='bx bxl-whatsapp-square'></i></a>
                    </div>
                </div>
            </div>
            <div class="footer-bottom">
                <p>&copy; 2025 LocaLooks</span>. All Rights Reserved.</p>
            </div>
        </footer>
        <!-- end footer -->
      </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.bundle.min.js"></script>

    <script>
        let products = null;
        let selectedSize = null;
        let selectedProductId = null;
        let cart = [];

        function showBootstrapAlert(message, type = 'success') {
            const existingAlert = document.querySelector('.alert-container');
            if (existingAlert) {
                existingAlert.remove();
            }

            let alertContainer = document.createElement('div');
            alertContainer.className = 'alert-container';
            alertContainer.style.cssText = 'position: fixed; top: 20px; right: 20px; z-index: 9999;';

            const alert = `
                <div class="alert alert-${type} alert-dismissible fade show" role="alert">
                    ${message}
                    <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
                </div>
            `;
            
            alertContainer.innerHTML = alert;
            document.body.appendChild(alertContainer);

            setTimeout(() => {
                const bsAlert = document.querySelector('.alert');
                if (bsAlert) {
                    const alert = bootstrap.Alert.getOrCreateInstance(bsAlert);
                    alert.close();
                }
            }, 3000);
        }

        function loadCart() {
            const savedCart = localStorage.getItem('cart');
            if (savedCart) {
                cart = JSON.parse(savedCart);
                updateCartCount();
            }
        }

        function saveCart() {
            localStorage.setItem('cart', JSON.stringify(cart));
            updateCartCount();
        }

        function updateCartCount() {
            const cartCount = document.querySelector('.badge');
            if (cartCount) {
                cartCount.textContent = cart.reduce((total, item) => total + item.quantity, 0);
            }
        }

        function selectSize(size) {
            selectedSize = size;
            const buttons = document.querySelectorAll('.size-button');
            buttons.forEach(button => button.classList.remove('selected'));
            buttons.forEach(button => {
                if (button.textContent === size) {
                    button.classList.add('selected');
                }
            });
        }

        function addToCart() {
            if (!selectedSize) {
                showBootstrapAlert('Please select a size before adding to cart!', 'danger');
                return;
            }

            const quantity = parseInt(document.getElementById('quantity-input').value);
            if (quantity < 1) {
                showBootstrapAlert('Please select a valid quantity!', 'danger');
                return;
            }

            const productId = new URLSearchParams(window.location.search).get('id');
            const product = products.find(p => p.id == productId);
            
            if (!product) {
                showBootstrapAlert('Product not found!', 'danger');
                return;
            }

            const cartItem = {
                id: product.id,
                name: product.name,
                price: product.price,
                size: selectedSize,
                quantity: quantity,
                image: product.image
            };

            const existingItemIndex = cart.findIndex(item => 
                item.id === cartItem.id && item.size === cartItem.size
            );

            if (existingItemIndex !== -1) {
                cart[existingItemIndex].quantity += quantity;
            } else {
                cart.push(cartItem);
            }

            saveCart();
            showBootstrapAlert(
                `Added to cart: ${cartItem.name} (Size: ${cartItem.size}) x${cartItem.quantity}`,
                'success'
            );
        }

        function updateDisplay(imageId) {
            const selectedImage = document.getElementById(imageId).src;
            document.getElementById('display').src = selectedImage;
        }

        function showDetail() {
            const productId = new URLSearchParams(window.location.search).get('id');
            selectedProductId = productId;

            const thisProduct = products.find(product => product.id == productId);
            if (!thisProduct) {
                window.location.href = "./fallback.html";
                return;
            }

            document.querySelector('#image').src = thisProduct.image;
            document.querySelector('#image1').src = thisProduct.image1;
            document.querySelector('#image2').src = thisProduct.image2;
            document.querySelector('#display').src = thisProduct.image;
            
            document.querySelector('.name').innerText = thisProduct.name;
            document.querySelector('.price').innerText = thisProduct.price;
            document.querySelector('.description').innerText = thisProduct.description;
            document.querySelector('.brand').innerText = thisProduct.brand;

            showRecommendedProducts();
        }

        function showRecommendedProducts() {
            const recommendedContainer = document.querySelector('.recommended-products');
            const recommendedProducts = products.filter(product => 
                product.category !== "accessories" && product.id !== selectedProductId
            );

            recommendedProducts.slice(0, 5).forEach(product => {
                const productDiv = document.createElement('div');
                productDiv.classList.add('product');
                
                productDiv.innerHTML = `
                    <div class="card" style="width: 18rem;">
                        <img src="${product.image}" class="card-img-top" alt="${product.name}">
                        <div class="card-body">
                            <p class="brand-name">${product.brand}</p>
                            <h5 class="baju">${product.name}</h5>
                            <p class="card-text"></p>
                        </div>
                        <div id="harga" class="card-body">
                            ${product.price}
                        </div>
                    </div>
                `;

                productDiv.addEventListener('click', () => {
                    window.location.href = `detail.html?id=${product.id}`;
                });

                recommendedContainer.appendChild(productDiv);
            });
        }

        fetch('https://fertan15.github.io/fileapi_product/products.json')
            .then(response => response.json())
            .then(data => {
                products = data;
                showDetail();
            })
            .catch(error => {
                console.error("Error fetching product data:", error);
                showBootstrapAlert('Failed to load product data. Please try again later.', 'danger');
            });

        document.addEventListener('DOMContentLoaded', loadCart);
    </script>
</body>
</html>